<!doctype html>
<html lang="he_IL" dir="rtl">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
    <link rel="stylesheet" type="text/css"
        href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
    <link href="vendor/css/material-dashboard.css" rel="stylesheet" />
    <link rel="stylesheet" href="vendor/bootstrap/css/bootstrap.min.css">

    <link rel="stylesheet" href="vendor/datetimepickeri18n/jquery.datetimepicker.css" type="text/css">

    <link href='https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" type="text/css" href="vendor/datatimepicker/daterangepicker.css" />
    <link rel="stylesheet" href="vendor/css/style.css" type="text/css">
    <link rel="shortcut icon" type="image/x-icon" href="img/favico.ico" />


    <title>המשלוחים שלי</title>
    <style>
        .modal-contents {
            width: 100%;
        }

        @media (max-width: 690px) {
            .popup {
                width: 90%;
            }
        }

        @media (min-height: 780px) {
            .popup {
                height: 615px !important;
            }
        }


        .popup {
            height: 70vh;
            width: 80%;
        }
    </style>


</head>
<div id="loader-wrapper">
    <div id="loader"></div>

    <div class="loader-section section-left"></div>
    <div class="loader-section section-right"></div>

</div>

<body id="orderssummary-distibutor">
    <div id="lock-modal"></div>
    <div id="loading-circle"></div>
    <div class="wrapper">
        <div id="sidebar" class="sidebar" data-color="green">
        </div>

        <div class="main-panel">
            <!-- Navbar -->
            <nav id="navbar" class="navbar navbar-expand-lg navbar-transparent navbar-absolute fixed-top ">

            </nav> <!-- End Navbar -->

            <div class="content">

                <div class="container-fluid">

                    <div class="wrapper">

                        <div class="container">
                            <div class="row">
                                <h3 class="heading">סיכום המשלוחים</h3>

                                <section id="filter">
                                    <div class="row filterbydate">
                                        <div class="container innerfilterbydate">
                                            <div id="reportrange"
                                                style="background: #fff; cursor: pointer; padding: 5px 10px; border: 1px solid #ccc;">
                                                <i class="bx bxs-calendar"></i>&nbsp;
                                                <span></span><i class='bx bx-caret-down' style="margin-right: 5px;"></i>
                                            </div>
                                            <!-- <button type="submit" class="btn btn_filter" id="btn_filter"
                                                    onclick="checkfileds()">חפש</button> -->
                                        </div>
                                    </div>

                                </section>




                                <section id="orders">




                                    <button class="btn btn-primary btn_update" id="btn_update"><span
                                            class='bx bx-cloud-upload'></span> עדכן רשומות</button>

                                    <table class="orderstable" id="orderstable">
                                        <thead>
                                            <tr>
                                                <th>תאריך הזמנה</th>
                                                <th>מספר הזמנה</th>
                                                <th>שולח</th>
                                                <th>מקבל</th>
                                                <th>סטטוס</th>
                                                <th>מפיץ</th>
                                                <th>
                                                    <div class="input-group side-checks"> <input type="checkbox"
                                                            id="check-all">
                                                    </div>
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody id="tbody"></tbody>

                                    </table>



                                    <div class="showmore">
                                        <button type="button" class="btn btn_showmore" id="btn_showmore">הצג
                                            עוד</button>
                                    </div>
                                </section>
                                <div>
                                    <img class="image-empty" id="image-empty" src="img/empty.svg" alt="אין תוצאות">

                                </div>

                            </div>


                        </div>
                        <div class="popup-container" id="popup-container">
                            <div class="popup-table">
                                <div class="popup-table-cell">
                                    <div class="popup">

                                        <div class="title">
                                            <span id="order-title"></span>

                                            <span class="closepopup"
                                                onclick="closepopup('popup-container')">&times;</span>

                                        </div>
                                        <div class="content">
                                            <div class="modal-contents" style="background-color:transparent;">
                                                <div class="orderdetails">
                                                    <div class="container">

                                                        <div class="row">
                                                            <div class="col">
                                                                <h3>שולח</h3>
                                                                <br>
                                                                <strong id="spickuppointname" for="pickuppointname">שם
                                                                    מלא:</strong>
                                                                <label id="pickuppointname"></label>
                                                                <br>
                                                                <strong id="spickuppointphone"
                                                                    for="pickuppointphone">מספר
                                                                    טלפון:</strong>
                                                                <label id="pickuppointphone"></label>
                                                                <br>
                                                                <strong id="spickuppointaddress"
                                                                    for="pickuppointaddress">כתובת:</strong>
                                                                <label id="pickuppointaddress"></label>
                                                                <br>
                                                                <strong id="spickuppointmail"
                                                                    for="pickuppointmail">מייל:</strong>
                                                                <label id="pickuppointmail"></label>
                                                                <br>
                                                                <strong id="spickuppointcomment"
                                                                    for="pickuppointcomment">הערה:</strong>
                                                                <label id="pickuppointcomment"></label>

                                                            </div>

                                                            <div class="col">
                                                                <div class="col">
                                                                    <h3>מקבל</h3>
                                                                    <br>
                                                                    <strong id="sdropoffpointname"
                                                                        for="dropoffpointname">שם
                                                                        מלא:</strong>
                                                                    <label id="dropoffpointname"></label>
                                                                    <br>
                                                                    <strong id="sdropoffpointphone"
                                                                        for="dropoffpointphone">מספר
                                                                        טלפון:</strong>
                                                                    <label id="dropoffpointphone"></label>
                                                                    <br>
                                                                    <strong id="sdropoffpointaddress"
                                                                        for="dropoffpointaddress">כתובת:</strong>
                                                                    <label id="dropoffpointaddress"></label>
                                                                    <br>
                                                                    <strong id="sdropoffpointmail"
                                                                        for="dropoffpointmail">מייל:</strong>
                                                                    <label id="dropoffpointmail"></label>
                                                                    <br>
                                                                    <strong id="sdropoffpointcomment"
                                                                        for="dropoffpointcomment">הערה:</strong>
                                                                    <label id="dropoffpointcomment"></label>

                                                                </div>
                                                            </div>

                                                        </div>
                                                        <div class="row">
                                                            <div class="col">
                                                                <h3 class="shipment_info">פרטי המשלוח</h3>

                                                            </div>
                                                        </div>
                                                        <div class="row">

                                                            <div class="col">
                                                                <br>
                                                                <strong id="sorderid" for="orderid">מספר מזהה:</strong>
                                                                <label id="orderid"></label>

                                                                <br>
                                                                <strong id="sordercreater" for="ordercreate">נוצר
                                                                    בתאריך:</strong>
                                                                <label id="ordercreate"></label>


                                                                <br>
                                                                <strong id="sordercreator"
                                                                    for="ordercreator">יוצר:</strong> <label
                                                                    id="ordercreator"></label>

                                                                <br>
                                                                <strong for="orderdelivery">תאריך מסירה :</strong>
                                                                <label id="orderdelivery"></label>
                                                                <br>
                                                                <strong id="sorderexternalid" for="orderexternalid">מספר
                                                                    מזהה חיצוני
                                                                    :</strong>
                                                                <label id="orderexternalid"></label>


                                                            </div>
                                                            <div class="col">
                                                                <br>
                                                                <strong id="sorderistributor" for="orderistributor">
                                                                    מפיץ:</strong>
                                                                <label id="orderistributor"></label>
                                                                <br>
                                                                <strong id="sorderstatus" for="orderstatus">
                                                                    סטטוס:</strong> <label id="orderstatus"></label>
                                                                <br>
                                                                <strong for="orderpickup">תאריך אסיפה:</strong> <label
                                                                    id="orderpickup"></label>
                                                                <br>
                                                                <strong id="sorderexternalstatus"
                                                                    for="orderexternalstatus">סטטוס
                                                                    חיצוני:</strong>
                                                                <label id="orderexternalstatus"></label>
                                                                <br>
                                                                <strong id="sordertype" for="ordertype">סוג:</strong>
                                                                <label id="ordertype"></label>

                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>




                    </div>
                </div>



            </div>

        </div>




        <div class="bg-modal " id="bg-modal">
            <div class="modal-contents">

                <span class="closepopup close_btn" onclick="closepopup('bg-modal')">&times;</span>
                <form action="" id="form_update">
                    <br>
                    <br>
                    <div class="row">

                        <div class="col-6">
                            <div class="date-input">
                                <label for="PickUpDate">תאריך איסוף: </label>
                                <input id="PickUpDate" type="text" name="PickUpDate" class="datetimepickeri18n update"
                                    autocomplete="off">

                            </div>
                        </div>

                        <div class="col-6">
                            <div class="date-input">
                                <label for="DeliveryDate">תאריך הגעה ליעד: </label>
                                <input id="DeliveryDate" type="text" name="DeliveryDate"
                                    class="datetimepickeri18n update" autocomplete="off">

                            </div>
                        </div>
                    </div>
                    <br>
                    <div class="row">

                        <div class="input-field">

                            <select list="status" class="form-control deliverystatus" name="status"
                                class="deliverystatus update" id="status">
                                <datalist id="status">
                                    <option value="" disabled selected hidden>סטטוס</option>
                                    <option value="נוצר">נוצר</option>
                                    <option value="מחכה לאיסוף">מחכה לאיסוף</option>
                                    <option value="בדרך ליעד">בדרך ליעד</option>
                                    <option value="נמסרה שליחות חלק ראשון (שליחות כפולה)">
                                        נמסרה שליחות חלק ראשון (שליחות כפולה)</option>
                                    <option value="נמסר">נמסר</option>
                                    <option value="בעיה במסירה">בעיה במסירה</option>
                                    <option value="בוטל">בוטל</option>
                                </datalist>
                            </select>
                        </div>
                    </div>
                    <a class="btn btn-primary btn_update" id="btn_update_on_popup" target="_blank"
                        onclick="updateDetails()">עדכן רשומות</a>

                </form>

            </div>
        </div>







    </div>


    </div>
    </div>

    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/js/popper.min.js"></script>
    <script src="vendor/js/material-dashboard.js"></script>
    <script src="vendor/js/bootstrap-material-design.min.js"></script>
    <script type="text/javascript" src="vendor/datatimepicker/moment.min.js"></script>
    <script type="text/javascript" src="vendor/datatimepicker/daterangepicker.js"></script>
    <script src="vendor/datetimepickeri18n/jquery.datetimepicker.full.min.js"></script>



    <script type="text/javascript " src="vendor/js/main.js"></script>
    <script type="text/javascript " src="vendor/js/distributor.js"></script>


    <script>
        window.onload = checkdistributor();
        window.onload = localStorage.setItem("lastid", 0);



        window.onload = loaddata();


        jQuery('.datetimepickeri18n').datetimepicker();
        jQuery.datetimepicker.setLocale('he');


        jQuery('.datetimepickeri18n').datetimepicker({
            timepicker: false,
            format: 'Y-m-d'
        });

        $(function () {
            $("#btn_showmore").on('click', function () {

                loaddata();

            });

            var start = moment().subtract(0, 'days');
            var end = moment();


            function cb(start, end) {
                $('#reportrange span').html('  מ -  ' + start.format('YYYY-MM-DD') + '  עד -   ' + end.format('YYYY-MM-DD'));

            }

            $('#reportrange').daterangepicker({
                opens: 'center',
                startDate: start,
                endDate: end,
                showCustomRangeLabel: false,
                alwaysShowCalendars: true,
                ranges: {
                    'היום': [moment(), moment()],
                    'אתמול': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
                    'השבוע האחרון': [moment().subtract(6, 'days'), moment()],
                    'ה- 30 ימים האחרונים': [moment().subtract(29, 'days'), moment()],
                    'החודש הזה': [moment().startOf('month'), moment().endOf('month')],
                    'חודש קודם': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
                }
            }, cb);

            $('#reportrange').on('apply.daterangepicker', function (ev, picker) {
                datefrom = picker.startDate.format('YYYY-MM-DD');
                dateto = picker.endDate.format('YYYY-MM-DD');
                console.log(picker.startDate.format('YYYY-MM-DD'));
                console.log(picker.endDate.format('YYYY-MM-DD'));
                loaddatabydate(datefrom, dateto);

            });


            cb(start, end);

        });

        document.getElementById('btn_update').addEventListener("click", function () {
            document.querySelector('.bg-modal').style.display = "flex";
            document.body.style = "overflow: hidden;margin: 0;height: 100%;";
            window.scrollTo(0, 0);



        });

        document.querySelector('.close_btn').addEventListener("click", function () {

            document.querySelector('.bg-modal').style.display = "none";
            document.body.style = "overflow: scroll";


        });


        var modal = document.querySelector('.order-model');
        window.onclick = function (event) {
            if (event.target == modal) {
                modal.style.display = "none";
                document.body.style = "overflow: scroll";

            }
        }


        var modal = document.querySelector('.bg-modal');
        window.onclick = function (event) {
            if (event.target == modal) {
                modal.style.display = "none";
                document.body.style = "overflow: scroll";

            }
        }

        const formupdate = document.getElementById("form_update");
        formupdate.addEventListener("submit", (e) => {
            e.preventDefault();
            showspinner();
        });

        $("#check-all").click(function () {
            // this function will get executed every time the #check-all element is clicked (or tab-spacebar changed)
            if ($(this).is(":checked")) // "this" refers to the element that fired the event
            {
                checkAll();
            }
        });

        $(document).ready(function () {

            document.getElementById("btn_update").disabled = true;

        });

        $('#orderstable').on('change', "input[type='checkbox']", function () { checkscheckbox(); });

        function checkscheckbox() {
            var len = $("input[type='checkBox']:checked").length;
            if (len == 0) {
                document.getElementById("btn_update").disabled = true;
                $("#check-all").prop('checked', false);
            }
            else {
                document.getElementById("btn_update").removeAttribute('disabled');



            }


        }





    </script>



</body>

</html>